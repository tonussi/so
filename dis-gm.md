#INE5412-04208A (20162) - Sistemas Operacionais I

## Discussion about Memory Management

Sobre o gerenciamento de memória, a primeira grande abordagem adotada nos sistemas operacionais é o gerenciamento e alocação contínua de memória, onde todo o espaço de endereçamento do processo fica armazenado numa partição contínua de memória, e em que existe a possibilidade de criar partições a priori, durante a instalação do sistema (partições estáticas, ou fixas) ou então criar partições durante à execução, conforme a demanda (partições dinâmicas, ou variáveis).

(a) Discuta sobre o que seria necessário ponderar para tomar a decisão entre utilizar partições estáticas ou dinâmicas e sobre suportar ou não compactação de memória e swap. Em sua discussão, inclua informações sobre as limitações do programador em relação ao os espaço de endereçamento do processo, como por exemplo o que aconteceria se ele resolvesse gerar endereços de memória bem altos (grandes) e sobre as exigências feitas sobre a relocação de código, como por exemplo se relocação em tempo de ligação pode ser usada num sistema que suporta swap.

(b) Supondo você tenha sido escolhido usar partições estáticas, discuta como você faria para definir a quantidade e o tamanho das partições. Uma vez definido isso, você precisa escolher entre haver uma fila única para todas as requisições de memória ou criar uma fila separada para cada partição de memória ou mesmo não haver filas. Como você faria essa escolha? Quais são as vantagens e limitações de cada opção? Em que situações o usuário poderia ser informado que não há memória para executar um processo?

(c) Supondo que tenha sido escolhido usar partições dinâmicas, discuta como você escolheria um algoritmo de alocação de memória. Qual algoritmo de alocação você acha que leva a uma melhor utilização de memória ou a menos fragmentação externa ou a um maior grau de multiprogramação? Discuta também sobre como decidir quando a desfragmentação (compactação) de memória deve ser realizada pelo sistema operacional. Que indicadores podem ser usados para determinar quando desfragmentar? Que algoritmos ou estratégias poderiam ser usados para fazer a desfragmentação de memória? Como você avaliaria esses algoritmos, ou seja, que características devem ter bons algoritmos de desfragmentação? Tente ilustrar uma boa estratégia desenhando um mapa de memória com bastante fragmentação e partições de diferentes tamanho, e mostre a sequência de cópias (moves) na memória para realizar a desfragmentação.

Sobre o gerenciamento de memória, a segunda e última grande abordagem adotada nos sistemas operacionais é o gerenciamento e alocação não-contínua de memória, onde o espaço de endereçamento do processo fica armazenado em diferentes blocos da memória, que não precisam estar alocados de forma contínua entre eles.

(a) Discuta sobre as limitações ou diferenças na forma de endereçamento gerado pelos programas quando se utiliza gerenciamento por paginação e por segmentação. Por exemplo, quantos espaços de endereçamento há em cada um desses mecanismos? Como ainda não estamos abordando memória virtual, qual é o limite desses espaços de endereçamento e o que acontece quando o programador gera um endereço bem alto (grande)?

(b)  Discuta sobre a utilização de memória e sobre algoritmos de alocação de memória para paginação, para segmentação e para segmentação paginada. Em algum deles o algoritmo é irrelevante? A utilização da memória com estratégias não-contínuas é igual, pior ou melhor do que com estratégias contínuas? Há alguma diferença na facilidade ou nos mecanismos utilizados para compartilhar e proteger memória?

(c) Discuta sobre a diferença de eficiência nas abordagens de desfragmentação de memória e swap quando usando paginação, segmentação e segmentação paginada quando comparadas a essas abordagens com memória contínua. Você considera que é necessário algum algoritmo diferente? Há diferenças na eficiência dos mesmos algoritmos nas estratégias contínua e não-contínua?

Sobre o gerenciamento de memória, quando a abordagem adotada é o gerenciamento e alocação não-contínua de memória, podemos também incluir o que denominamos de memória virtual.\item (a) Discuta as vantagens e desvantagens especificamente da memória virtual em relação às estratégias de gerenciamento não-contínuo sem memória virtual.

(b) Assumindo que se esteja trabalhando com memória virtual com paginação, discuta qual seria a sequência de passos (algoritmo) mais próxima de uma implementação real que represente as ações que o sistema operacional deve tomar durante uma falta de página.

(c) Suponha uma arquitetura de 64 bits. Qual é o espaço de endereçamento de um processo qualquer? O que aconteceria se um programador gerasse um endereço bem alto (grande, próximo de $2^{64}$) ou qualquer outro endereço? O que sua resposta implica em relação à quantidade de descritores de páginas que devem estar presentes na tabela de páginas daquele processo? Uma suposição realista é que um descritor ocupe 4 bytes. Então qual seria o tamanho da tabela de páginas de cada processo? Discuta os efeitos disso se você imaginar que nas máquinas atuais há cerca de 2GB de memória RAM e que pode haver facilmente mais de uma dúzia de processos carregados na memória. Finalmente, indique possíveis soluções para esse grave problema e informe qual deve ser o suporte de hardware necessário para ele, afinal, o sistema operacional pode não ser capaz de implementar uma solução se esse suporte não existir.

Imagine o que pode acontecer quando aumentamos muito o grau de multiprogramação, carregando mais e mais programas na memória RAM, e eles começam a fazer diferentes referências à memória. Que grave problema isso pode causar? Existem abordagens que o sistema operacional poderia usar para prevenir a ocorrência desse problema? Como ele poderia fazer isso? Se o problema já está acontecendo, discuta as possibilidades reais do sistema operacional para recuperar o sistema dessa situação. Quais são as alternativas e quais são as vantagens e limitações delas?
